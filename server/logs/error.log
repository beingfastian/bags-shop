{"level":"error","message":"Forgot password controller error: Transaction cannot be rolled back because it has been finished with state: commit","stack":"Error: Transaction cannot be rolled back because it has been finished with state: commit\n    at Transaction.rollback (E:\\GHAYAS\\bags-shop-server\\node_modules\\sequelize\\lib\\transaction.js:59:13)\n    at forgotPassword (file:///E:/GHAYAS/bags-shop-server/app/services/authService.ts:143:27)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async forgotPasswordController (file:///E:/GHAYAS/bags-shop-server/app/controllers/authController.ts:17:24)","timestamp":"2025-02-01T11:33:13.089Z"}
{"level":"error","message":"Auth service error (forgotPassword): column OTP.deletedAt does not exist","name":"SequelizeDatabaseError","original":{"code":"42703","file":"parse_relation.c","length":111,"line":"3721","name":"error","position":"56","routine":"errorMissingColumn","severity":"ERROR","sql":"SELECT count(*) AS \"count\" FROM \"OTPs\" AS \"OTP\" WHERE (\"OTP\".\"deletedAt\" IS NULL AND (\"OTP\".\"userId\" = '350cceb6-c7fe-4f39-9787-f18924253e52' AND \"OTP\".\"purpose\" = 'password_reset' AND \"OTP\".\"createdAt\" > '2025-02-01 11:19:23.334 +00:00'));"},"parameters":{},"parent":{"code":"42703","file":"parse_relation.c","length":111,"line":"3721","name":"error","position":"56","routine":"errorMissingColumn","severity":"ERROR","sql":"SELECT count(*) AS \"count\" FROM \"OTPs\" AS \"OTP\" WHERE (\"OTP\".\"deletedAt\" IS NULL AND (\"OTP\".\"userId\" = '350cceb6-c7fe-4f39-9787-f18924253e52' AND \"OTP\".\"purpose\" = 'password_reset' AND \"OTP\".\"createdAt\" > '2025-02-01 11:19:23.334 +00:00'));"},"sql":"SELECT count(*) AS \"count\" FROM \"OTPs\" AS \"OTP\" WHERE (\"OTP\".\"deletedAt\" IS NULL AND (\"OTP\".\"userId\" = '350cceb6-c7fe-4f39-9787-f18924253e52' AND \"OTP\".\"purpose\" = 'password_reset' AND \"OTP\".\"createdAt\" > '2025-02-01 11:19:23.334 +00:00'));","stack":"Error\n    at Query.run (E:\\GHAYAS\\bags-shop-server\\node_modules\\sequelize\\lib\\dialects\\postgres\\query.js:50:25)\n    at E:\\GHAYAS\\bags-shop-server\\node_modules\\sequelize\\lib\\sequelize.js:315:28\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PostgresQueryInterface.rawSelect (E:\\GHAYAS\\bags-shop-server\\node_modules\\sequelize\\lib\\dialects\\abstract\\query-interface.js:434:18)\n    at async OTP.aggregate (E:\\GHAYAS\\bags-shop-server\\node_modules\\sequelize\\lib\\model.js:1277:19)\n    at async OTP.count (E:\\GHAYAS\\bags-shop-server\\node_modules\\sequelize\\lib\\model.js:1306:20)\n    at async forgotPassword (file:///E:/GHAYAS/bags-shop-server/app/services/authService.ts:111:32)\n    at async forgotPasswordController (file:///E:/GHAYAS/bags-shop-server/app/controllers/authController.ts:17:24)","timestamp":"2025-02-01T11:34:23.355Z"}
{"level":"error","message":"Forgot password controller error: column OTP.deletedAt does not exist","stack":"Error: column OTP.deletedAt does not exist\n    at handleServiceError (file:///E:/GHAYAS/bags-shop-server/app/services/authService.ts:261:11)\n    at forgotPassword (file:///E:/GHAYAS/bags-shop-server/app/services/authService.ts:144:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async forgotPasswordController (file:///E:/GHAYAS/bags-shop-server/app/controllers/authController.ts:17:24)","timestamp":"2025-02-01T11:34:23.360Z"}
